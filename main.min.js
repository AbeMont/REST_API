console.log("Data Rest API");var UIController={modal:{modalInfo:function(linksArr){console.log(linksArr);for(let i=0;i<linksArr.length;i++)console.log(linksArr[i]),linksArr[i].addEventListener("click",()=>{let anchorName=linksArr[i].dataset.openModal,http=new XMLHttpRequest;http.onreadystatechange=(()=>{if(200===http.status&&4===http.readyState){let data;JSON.parse(http.responseText).forEach(person=>{if(person.name===anchorName){console.log(person);let modal=document.querySelector(".modal"),modalTitle=document.querySelector(".modal h1"),modalImg=document.querySelector(".modal img"),modalUl=document.querySelector(".modal ul"),contactInfo={email:person.email,address:person.address,phoneNumber:person.phone,website:person.website},ulChildren;if(modalImg.src=person.profilePic,modalTitle.textContent=person.name,modal.classList.add("active"),Array.from(document.querySelectorAll(".modal ul"))[0].children.length>=4)return!1;for(let prop in contactInfo){let li=document.createElement("li"),liInfo=modalUl.appendChild(li);liInfo.textContent="address"===prop?`${person.address.street} .St, ${person.address.suite} ${person.address.city}, ${person.address.zipcode}`:contactInfo[prop]}}})}}),http.open("GET","./users.json",!0),http.send()})},openModal:function(){window.onclick=(e=>{e.target===document.querySelector(".modal")&&this.resetModal()})},closeModal:function(){document.querySelector(".modal__close").addEventListener("click",()=>{this.resetModal()})},resetModal:function(){document.querySelector(".modal__body").classList.add("remove"),setTimeout(()=>{document.querySelector(".modal").classList.remove("active"),document.querySelector(".modal__body").classList.remove("remove")},300);let modalUl=Array.from(document.querySelectorAll(".modal ul")),ulEl=document.querySelector(".modal ul"),modalChildren=Array.from(modalUl[0].children);for(let i=0;i<modalChildren.length;i++)ulEl.removeChild(modalChildren[i])}},createHtml:function(data,name,value){this.value=value,console.log(data);let section=document.createElement("section"),anchor=document.createElement("a"),anchorInfo=document.createElement("a"),span=document.createElement("span"),img=document.createElement("img"),divName=document.createElement("div"),divInfo=document.createElement("div"),h3=document.createElement("h3"),ul=document.createElement("ul"),randomId=(9999*Math.random()).toFixed(),currentSection=document.querySelector(".show-info-"+this.value).appendChild(section);currentSection.id=randomId,currentSection.classList.add("data-section"),currentSection.dataset.section=`${data.name} ${this.value}`;let nameSection=currentSection.appendChild(divName);nameSection.classList.add("data-section__name");let infoSection=currentSection.appendChild(divInfo);infoSection.classList.add("data-section__info");let sectionAnchor=nameSection.appendChild(anchor);anchor.textContent="X",anchor.href="javascript:void(0)",anchor.classList.add("close"),nameSection.appendChild(h3).textContent=data.name,nameSection.appendChild(img).src=data.profilePic;let infoUl=infoSection.appendChild(ul),companyInfo;[{Username:data.username},{Company:data.company.name},{Occupation:data.company.occupation}].forEach(listItem=>{let li=document.createElement("li"),b=document.createElement("b"),span=document.createElement("span"),generatedLi=infoUl.appendChild(li);for(let prop in listItem){let boldDesc;generatedLi.appendChild(b).textContent=prop+": ";let value=generatedLi.appendChild(span);value.classList.add("light"),value.textContent=listItem[prop]}});let contactAnchor=infoSection.appendChild(anchorInfo);contactAnchor.href="javascript:void(0)",contactAnchor.dataset.openModal=data.name,contactAnchor.textContent="View Contant Info",console.log(currentSection),console.log(this),this.getSections(),this.modal.modalInfo(currentSection,data)},getSections:function(){sections=Array.from(document.querySelectorAll("[data-section]")),this.removeSections(sections)},removeSections:function(allSections){allSections.forEach(section=>{section.children[0].addEventListener("click",()=>{section.classList.add("remove"),setTimeout(()=>{section.remove()},300)})})},loadSpinner:function(httpReq,section){200===httpReq.status&&(document.querySelector(`${section} .loader-container`).classList.add("show"),setTimeout(()=>{document.querySelector(`${section} .loader-container`).classList.remove("show")},900))},generateDropdowns:function(parameter){this.parameter=parameter,console.log(this.parameter);let http=new XMLHttpRequest;http.onreadystatechange=(()=>{if(200===http.status&&4===http.readyState){let data=JSON.parse(http.responseText),paramerters=[];console.log(paramerters);let allParameters=data.map(person=>person.company[this.parameter]);console.log(allParameters),allParameters.forEach(item=>{paramerters.length?-1===paramerters.indexOf(item)&&paramerters.push(item):paramerters.push(item)}),console.log(paramerters);let parameterDropdown=document.getElementById(this.parameter+"-dropdown");console.log(parameterDropdown),paramerters.forEach(item=>{let option=document.createElement("option"),panel=parameterDropdown.appendChild(option);panel.textContent=item,panel.value=item,panel.dataset[this.parameter]=""})}}),http.open("GET","./users.json",!0),http.send()}};UIController.modal.openModal(),UIController.modal.closeModal(),UIController.generateDropdowns("name"),setTimeout(()=>{UIController.generateDropdowns("occupation")},100),document.querySelector("#firstname").addEventListener("click",function(){let name=document.getElementById("name-person").value.toLowerCase(),sections=void 0;if(console.log(name),""===name)return alert("Please enter a Name."),!1;{let request=new XMLHttpRequest,personFound=!1;request.onreadystatechange=function(){if(console.log(request),UIController.loadSpinner(request,".show-info-name"),200===request.status&&4===request.readyState){var response=JSON.parse(request.responseText);console.log(response),console.log(request),response.forEach(person=>{let firstName;if(firstName="mrs."==person.name.toLowerCase().split(" ")[0]?person.name.toLowerCase().split(" ")[1]:person.name.toLowerCase().split(" ")[0],name===firstName)if(document.querySelector(`[data-section="${person.name} name"]`)){if(document.querySelector(`[data-section="${person.name} name"]`))return personFound=!0,document.getElementById("name-person").value="",!1}else UIController.createHtml(person,firstName,"name"),personFound=!0,document.getElementById("name-person").value=""});let modalLinks=Array.from(document.querySelectorAll("[data-open-modal]"));console.log(modalLinks),UIController.modal.modalInfo(modalLinks),personFound||(alert(`No such person with the name of ${name} is found on the server`),document.getElementById("name-person").value="")}},request.open("GET","./users.json",!0),request.send()}}),document.querySelector("#company-btn").addEventListener("click",()=>{let company=document.getElementById("name-dropdown").value,companyFound=!1;if(console.log(company),""===company)return alert("Please enter a company name."),!1;{let http=new XMLHttpRequest;http.onreadystatechange=(()=>{if(UIController.loadSpinner(http,".show-info-company"),200===http.status&&4===http.readyState){let data=JSON.parse(http.responseText);console.log(data),data.forEach(person=>{let companyName;if(person.company.name===company){if(console.log(person),document.querySelector(`[data-section="${person.name} company"]`))return document.getElementById("company-person").value="",companyFound=!0,!1;document.querySelector(`[data-section="${person.name} company"]`)||(UIController.createHtml(person,person.name,"company"),companyFound=!0)}});let modalLinks=Array.from(document.querySelectorAll("[data-open-modal]"));UIController.modal.modalInfo(modalLinks),companyFound||(alert(`No company with the name of ${company} is found in the server.`),document.getElementById("company-person").value="")}}),http.open("GET","./users.json",!0),http.send()}}),document.getElementById("occupation-btn").addEventListener("click",()=>{let value=document.querySelector("#occupation-dropdown").value,occupationFound=!1;if(console.log(value),""==value)return alert("Please enter an occupation"),!1;{let http=new XMLHttpRequest;http.onreadystatechange=(()=>{if(UIController.loadSpinner(http,".show-info-occupation"),200===http.status&&4===http.readyState){let data=JSON.parse(http.responseText);console.log(data),data.forEach(person=>{let occupation=person.company.occupation;if(console.log(occupation),occupation!==value)return!1;console.log(person),document.querySelector(` [data-section ="${person.name} occupation"] `)?document.querySelector(` [data-section ="${person.name} occupation"] `)&&(occupationFound=!0):(occupationFound=!0,UIController.createHtml(person,person.name,"occupation"))});let modalLinks=Array.from(document.querySelectorAll("[data-open-modal]"));UIController.modal.modalInfo(modalLinks),occupationFound||(alert("Please enter a valid Occupation."),document.querySelector("#occupation-dropdown").value="")}}),http.open("GET","./users.json",!0),http.send()}});